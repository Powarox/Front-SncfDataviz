<!DOCTYPE html>
<html lang="en" dir="ltr">
    <head>
        <meta charset="utf-8">
        <title></title>
        <script src="script.js" charset="utf-8"></script>
    </head>
    <body>

    </body>
    <script src="https://d3js.org/d3.v3.min.js"></script>


    <script>
        const width = 800,
            height = 800,
            hexRadius = 5;
        var projection,
            svg,
            hexbin,
            colorScale,
            maxDatapoints;

        svg = d3.select('#map').append("svg")
            .attr("id", "svg")
            .attr("width", width + hexRadius * 2)
            .attr("height", height + hexRadius * 2);

        var promises = [];
        promises.push(d3.json('d3js/map-hexgrid/https://www.datavis.fr/d3js/map-hexgrid/departments.json'));
        promises.push(d3.csv('d3js/map-hexgrid/communes.csv'));
        Promise.all(promises).then(function(values) {
            const geojson = values[0];
            const csv = values[1];

            // ready(geojson, csv);
        });

        // function ready(geojson, csv) {
        //     // Initialisation de la projection
        //     drawGeo(geojson);
        //
        //     // On place les futures centres de nos hexgrid sur le SVG en fonction de sa taille
        //     var points = getPointGrid(hexRadius);
        //
        //     // On récupère les polygones de tous les départements au format X,Y
        //     var frPolygons = getPolygons(geojson);
        //
        //     // On ne conserve que les centres de nos hexgrid qui sont dans l'un des polygones
        //     var frPoints = keepPointsInPolygon(points, frPolygons);
        //
        //     // Construction d'un tableau avec les coordonnées de chaque ville
        //     var dataPoints = getDatapoints(csv);
        //
        //     // On concatène tous les centres des hexgrid avec les coordonnées de chaque ville.
        //     var mergedPoints = frPoints.concat(dataPoints);
        //
        //     // Regroupement de nos points par hexagones en utilisant la libraire hexbin
        //     var hexPoints = getHexPoints(mergedPoints);
        //
        //     // Ajout d'informations résumées à chaque hexagone
        //     var hexPointsRolledup = rollupHexPoints(hexPoints);
        //
        //     // Ajout des hexagones au SVG
        //     drawHexmap(hexPointsRolledup);
        //
        //     // Ajout d'une légende
        //     drawLegend();
        //
        //     // Ajout des interractions avec la souris
        //     mouseInteractivity();
        // }
        //
        // function drawGeo(geojson) {
        //     projection = d3.geoConicConformal().fitSize([width, height], geojson);
        //
        //     var geoPath = d3.geoPath()
        //     	.projection(projection);
        //
        //     const deps = svg.append("g");
        //
        //     deps.selectAll("path")
        //     	.data(geojson.features)
        //     	.enter()
        //     		.append("path")
        //     		.attr("d", path);
        // }
        //
        // function getPointGrid(radius) {
        //     var hexDistance = radius * 1.5;
        //     var cols = width / hexDistance;
        //
        //     var rows = Math.floor(height / hexDistance);
        //
        //     return d3.range(rows * cols).map(function(i) {
        //         return {
        //             x: i % cols * hexDistance,
        //             y: Math.floor(i / cols) * hexDistance,
        //             datapoint: 0
        //         };
        //     });
        // }

    </script>
</html>
